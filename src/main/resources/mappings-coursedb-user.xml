<?xml version="1.0" encoding="UTF-8" ?>
<entity-mappings xmlns="http://xmlns.jcp.org/xml/ns/persistence/orm"
                 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                 xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence/orm
                                     http://xmlns.jcp.org/xml/ns/persistence/orm_2_1.xsd"
                 version="2.1">
	<description>Entity mappings for the course database</description>
	<package>ca.uoguelph.socs.icc.edm.domain.core</package>
	<schema>userdb</schema>
	<access>PROPERTY</access>

	<!--*********************************************************************-->
	<!--  Core data mapping: Users                                           -->
	<!--*********************************************************************-->

	<entity name="User" class="UserData" metadata-complete="true">
		<description>Data identifying the user</description>
		<table name="user"/>
		<named-query name="UserData:maxid">
			<query>SELECT MAX(u.id) FROM User u</query>
		</named-query>
		<named-query name="UserData:allid">
			<query>SELECT u.id FROM User u</query>
		</named-query>
		<named-query name="UserData:all">
			<query>SELECT u FROM User u</query>
		</named-query>
		<named-query name="UserData:idnumber">
			<query>SELECT u FROM User u WHERE u.idNumber = :idnumber</query>
		</named-query>
		<named-query name="UserData:username">
			<query>SELECT u FROM User u WHERE u.username = :username</query>
		</named-query>
		<attributes>
			<id name="id">
				<column name="id" nullable="false" unique="true"/>
				<generated-value strategy="SEQUENCE" generator="user_id_seq"/>
				<sequence-generator name="user_id_seq" sequence-name="userdb.user_id_seq" initial-value="1" allocation-size="1"/>
			</id>
			<basic name="idNumber">
				<column name="id_number" />
			</basic>
			<basic name="username">
				<column name="username" nullable="false" unique="true"/>
			</basic>
			<basic name="firstname">
				<column name="first_name" nullable="false"/>
			</basic>
			<basic name="lastname">
				<column name="last_name" nullable="false"/>
			</basic>
			<one-to-many name="enrolments" target-entity="EnrolmentData">
				<join-table name="user_enrolment">
					<join-column name="enrolment_id" nullable="false" referenced-column-name="id"/>
					<inverse-join-column name="user_id" nullable="false" referenced-column-name="id"/>
				</join-table>
			</one-to-many>
			<transient name="name"/>
		</attributes>
	</entity>
</entity-mappings>
